# sample-ldap-login
"sample-ldap-login" provides a login form to authenticate users through a LDAP Server.
User should provide username and password and the application should contact the LDAP Server and verify credentials. If authentication succeeds, print a welcome message that includes name and surname of the user, stored respectively in cn and sn attributes.

## Requirements

- Use Java 8 to write your code;
- LDAP Server must have directory entry root “dc=myorg,dc=test” and you should import LDIF file we
provide to you in order to initialize it;
- LDAP connection parameters should be stored in a configuration file that will be located in the same path of the jar file. It must be editable in order to allow connection to another LDAP server populated with the same LDIF file;
- Usernames are stored in uid attribute; passwords are stored and hashed in userpassword attribute and are the same for every user: Password123!

### Bonus features
Improve the application security implementing two-factor authentication.
After a correct authentication, user should provide an OTP in order to access to protected content, as follow:
- OTP should be implemented as TOTP (Time-based One-Time Password), described in RFC6238 (https://tools.ietf.org/html/rfc6238);
- TOTP algorithm parameters should be the following:
- Timestep : 20 seconds;
- OTPlength : 8 digits;
- Hashing algorithm : SHA256
- Secret : base32 encoded and stored in user's LDAP attribute “l”(lowercase L).
- Tests should be executed installing on your smartphone a TOTP generator as FreeOTP Authenticator, scanning a QR code for each user. QR Codes could be generated with your favorite tool and it should include an URL in the following format (specified in https://github.com/google/google-authenticator/wiki/Key-Uri-Format):

```
otpauth://totp/<username>? secret=<secret>&issuer=<indifferente>&algorithm=SHA256&digits=8&period=20
```

# My solution

In order to try my software, I used an LDAP server (OUD) that I had previously set up for work reasons.
Since the LDAP server I used was already configured, I didn't use the provided LDIF, but I set up a properties where you can indicate the LDAP Searchbase that you want to use. In this way the same application can be used on any LDAP tree.

**To use the application follow the instruction below:**
- Download the jar and the properties files that you can find in the *out* folder (the properties and the jar files must be in the same folder).
- Edit the *ldap.properties* file changing the parameters if necessary.
- Double-click on the jar file.
- Insert the credentials in the appropriate dialog box.

**The application will respond as follows:**

- If the credentials are correct, a welcome message will be returned.
- If the credentials are incorrect, an error message will be returned.
- In the event that the LDAP server is not reachable, an error like "Unable to establish a connection to LDAP" will be displayed.
- In the event that no username is entered, an error like "Invalid username, Try again." will be displayed.
- In the event that the user logged in does not have the CN and/or SN attributes, an error like "Unable to obtain attribute for username" will be displayed.

*In the code, you can also find a part concerning the generation of the OTP.
The token is generated, but does not match the one generated by the application "Free OTP Authenticator".*

